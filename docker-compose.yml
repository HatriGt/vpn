version: '3.8'

services:
  wg-easy:
    image: weejewel/wg-easy
    container_name: wg-easy
    environment:
      # Your VPS public IP or domain name
      - WG_HOST=${WG_HOST}
      # Password for the web UI (change this!)
      - PASSWORD=${WG_PASSWORD}
      # WireGuard port (default: 51820)
      - WG_PORT=${WG_PORT:-51820}
      # Web UI port (default: 51821)
      - WG_DEFAULT_ADDRESS=${WG_DEFAULT_ADDRESS:-10.8.0.x}
      # Default DNS server
      - WG_DEFAULT_DNS=${WG_DEFAULT_DNS:-1.1.1.1}
      # Allowed IPs (0.0.0.0/0 means route all traffic through VPN)
      - WG_ALLOWED_IPS=${WG_ALLOWED_IPS:-0.0.0.0/0, ::/0}
      # MTU size
      - WG_MTU=${WG_MTU:-1420}
      # Enable persistent keepalive
      - WG_PERSISTENT_KEEPALIVE=${WG_PERSISTENT_KEEPALIVE:-25}
    ports:
      # WireGuard UDP port
      - "${WG_PORT:-51820}:51820/udp"
      # Web UI port
      - "${WG_WEB_PORT:-51821}:51821/tcp"
    volumes:
      # Persist WireGuard configuration
      - ./wg-easy-data:/etc/wireguard
    cap_add:
      - NET_ADMIN
      - SYS_MODULE
    sysctls:
      - net.ipv4.ip_forward=1
      - net.ipv4.conf.all.src_valid_mark=1
    restart: unless-stopped
    networks:
      - vpn-network

networks:
  vpn-network:
    driver: bridge
